<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Login Facial</title>
    <style>
        body { font-family: sans-serif; text-align: center; margin-top: 50px; }
        img { border: 2px solid #ccc; }
        .container { max-width: 640px; margin: auto; }
        #welcome-message { font-size: 1.2em; color: green; font-weight: bold; height: 30px;}
    </style>
</head>
<body>
    <div class="container">
        <h1>Login por Reconhecimento Facial</h1>
        <p>Posicione seu rosto em frente à câmera para fazer login.</p>
        <img src="{{ url_for('video_feed_login') }}" width="640" height="480">
        <div id="welcome-message"></div>
        <p>Não tem uma conta? <a href="{{ url_for('register') }}">Cadastre-se</a></p>
    </div>

    <script>
        // A cada 2 segundos, verifica se o usuário foi logado e redireciona
        const welcomeMessage = document.getElementById('welcome-message');
        
        const intervalId = setInterval(function() {
            fetch('/check_login_status')
                .then(response => response.json())
                .then(data => {
                    if (data.logged_in) {
                        welcomeMessage.innerText = `Bem-vindo, ${data.user}! Redirecionando...`;
                        clearInterval(intervalId); // Para de verificar
                        setTimeout(() => {
                           window.location.href = "{{ url_for('quiz') }}";
                        }, 1500); // Espera um pouco antes de redirecionar
                    }
                });
        }, 2000);
    </script>
</body>
</html>